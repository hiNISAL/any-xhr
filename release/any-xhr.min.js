!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.AnyXHR=t()}(this,function(){"use strict";var e=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();return function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),n.instance)return n.instance;this.XHR=window.XMLHttpRequest,this.hooks=e,this.execedHooks=t,this.init(),n.instance=this}return e(n,[{key:"init",value:function(){var e=this;window.XMLHttpRequest=function(){this._xhr=new e.XHR,e.overwrite(this)}}},{key:"add",value:function(e,t){return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]?this.execedHooks[e]=t:this.hooks[e]=t,this}},{key:"overwrite",value:function(e){for(var t in e._xhr)"function"!=typeof e._xhr[t]?this.overwriteAttributes(t,e):this.overwriteMethod(t,e)}},{key:"overwriteMethod",value:function(i,r){var s=this.hooks,u=this.execedHooks;r[i]=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!s[i]||!1!==s[i].call(r,t)){var o=r._xhr[i].apply(r._xhr,t);return u[i]&&u[i].call(r._xhr,o),o}}}},{key:"overwriteAttributes",value:function(e,t){Object.defineProperty(t,e,this.setProperyDescriptor(e,t))}},{key:"setProperyDescriptor",value:function(i,r){var e=Object.create(null),s=this;return e.set=function(o){i.startsWith("on")?s.hooks[i]?this._xhr[i]=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];s.hooks[i].call(r),o.apply(r,t)}:this._xhr[i]=o:r["__"+i]=o},e.get=function(){return r["__"+i]||this._xhr[i]},e}},{key:"getInstance",value:function(){return n.instance}},{key:"rmHook",value:function(e){delete(1<arguments.length&&void 0!==arguments[1]&&arguments[1]?this.execedHooks:this.hooks)[e]}},{key:"clearHook",value:function(){this.hooks={},this.execedHooks={}}},{key:"unset",value:function(){window.XMLHttpRequest=this.XHR}},{key:"reset",value:function(){n.instance=null,n.instance=new n(this.hooks,this.execedHooks)}}]),n}()});
